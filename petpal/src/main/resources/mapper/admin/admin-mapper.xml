<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "- //mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="admin">
	<select id="selectClaimAll" resultType="map">
		SELECT * FROM CLAIM JOIN MEMBER USING(MEMBERNO)
	</select>
	<select id="selectClaimOne" parameterType="string" resultType="map">
		SELECT * FROM CLAIM JOIN MEMBER USING(MEMBERNO) WHERE CLAIMNO=#{claimNo}
	</select>
	<delete id="claimDelete" parameterType="string">
		DELETE FROM CLAIM WHERE CLAIMNO=#{claimNo}
	</delete>
	<update id="claimAccept" parameterType="string">
		UPDATE CLAIM SET STATUS='Y' WHERE CLAIMNO=#{claimNo}
	</update>
	<select id="selectPlaceList" resultType="map">
		select * from place join member using(MEMBERNO)ORDER BY PLACEDATE DESC
	</select>
	<select id="selectPlaceOne" resultType="map" parameterType="string">
		SELECT * FROM PLACE JOIN MEMBER USING(MEMBERNO) WHERE PLACENO=#{placeNo}
	</select>
	<update id="updatePlace" parameterType="map">
		UPDATE PLACE SET STATUS=#{status} WHERE PLACENO=#{placeNo}
	</update>
	<select id="orderSearch" resultType="map" parameterType="map">
		  SELECT * FROM payment p left JOIN member m ON M.MEMBERNO=P.MEMBERNO
		<where>
			<if test="type != null and key != null">
				AND ${type} like '%'|| #{key}||'%'
			</if>
			<if test="status != null">
				AND PAYSTATUS = #{status}
			</if>
		</where>
		ORDER BY PAYDATE DESC
	</select>
	<select id="memberSearch" parameterType="map" resultType="map">
		SELECT * FROM MEMBER 
		<where>
			<if test="type != null and key != null">
				AND ${type} like '%'|| #{key}||'%'
			</if>
		</where>
	</select>
	<select id="searchClaim" parameterType="map" resultType="map">
		SELECT * FROM CLAIM JOIN MEMBER USING(MEMBERNO)
		<where>
			<if test="type != null and key != null">
				AND ${type} like '%'|| #{key}||'%'
			</if>
		</where>
	</select>
	<select id="searchCommunity"  parameterType="map" resultType="map">
		select * from place join member using(MEMBERNO)
		<where>
			<if test="type != null and key != null">
				AND ${type} like '%'|| #{key}||'%'
			</if>
			<if test="status != null">
				AND STATUS = #{status}
			</if>
		</where>
		ORDER BY PLACEDATE DESC
	</select>
	<select id="cumTotalCount" resultType="_int">
		select count(*) from place join member using(MEMBERNO)
	</select>
	<select id="claimTotalCount" resultType="_int">
		SELECT count(*) FROM CLAIM JOIN MEMBER USING(MEMBERNO)
	</select>
	<select id="mTotalCount" resultType="_int">
		SELECT count(*) FROM MEMBER
	</select>
	
</mapper>
