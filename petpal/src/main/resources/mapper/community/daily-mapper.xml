<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "- //mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="daily">
	<insert id="insertDaily" parameterType="daily">
		INSERT INTO DAILY VALUES('D'||SEQ_DAILYNO.NEXTVAL,#{memberNo},#{content},SYSDATE)
		<selectKey keyProperty="dailyNo" resultType="string" order="AFTER">
			SELECT 'D'||SEQ_DAILYNO.CURRVAL FROM DUAL
		</selectKey>
	</insert>
	<insert id="insertDailyImg" parameterType="dailyImg">
		INSERT INTO DAILYIMG VALUES(SEQ_DAILYIMGNO.NEXTVAL,#{dailyNo},#{dailyImgName},#{status})
		<selectKey keyProperty="dailyImgNo" resultType="string" order="AFTER">
			SELECT SEQ_DAILYIMGNO.CURRVAL FROM DUAL
		</selectKey>
	</insert>
	<insert id="insertDailyCoords" parameterType="dailyCoord">
		INSERT INTO COORD VALUES(#{dailyImgNo},#{productNo},#{xxCode},#{yyCode})
	</insert>
	<select id="selectProductName" parameterType="string" resultType="product">
		SELECT * FROM PRODUCT WHERE PRODUCTNAME LIKE '%${value}%'
	</select>
	<select id="selectProductNo" parameterType="string" resultType="string">
		SELECT PRODUCTNO FROM PRODUCT WHERE PRODUCTNAME=#{name}
	</select>
	<select id="selectDailyProduct" parameterType="string" resultType="pImg">
		SELECT * FROM PRODUCTIMG WHERE PRODUCTNO=#{productNo} AND TYPE='M'
	</select>
	<select id="selectProductAll" resultType="product">
		SELECT * FROM PRODUCT
	</select>
	<insert id="insertHashtag" parameterType="hashtag">
		INSERT INTO HASHTAG VALUES(#{postNo},#{hashContent})
	</insert>
	<select id="selectDailyAll" resultType="map">
		SELECT * FROM DAILY LEFT JOIN MEMBER USING(MEMBERNO)
	</select>
	<select id="selectMainImg" resultType="dailyImg">
		SELECT * FROM DAILYIMG WHERE STATUS='M'
	</select>
	<select id="selectHashAll" resultType="hashtag">
		SELECT * FROM HASHTAG WHERE POSTNO LIKE 'D%'
	</select>
</mapper>
